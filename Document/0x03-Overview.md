# 概要

## OWASP モバイルセキュリティテストガイドの序文

新しいテクノロジは常に新しいセキュリティリスクをもたらします。モバイルコンピューティングも例外ではありません。モバイルアプリのセキュリティに関する懸念事項は従来のデスクトップソフトウェアとはいくつかの重要な点で異なります。現代のモバイルオペレーティングシステムは従来のデスクトップオペレーティングシステムよりもほぼ間違いなくセキュアであるといえますが、モバイルアプリ開発の中でセキュリティを慎重に考慮していなければ問題はまだ発生する可能性があります。データストレージ、アプリ間通信、暗号 API の適切な使用方法、セキュアなネットワーク通信はこれらの考慮事項のほんの一部に過ぎません。

### モバイルアプリケーションセキュリティの主要な領域

多くのモバイルアプリのペネトレーションテスト担当者はネットワークやウェブアプリのペネトレーションテストのバックグラウンドがあり、モバイルアプリテストに価値のある品質を有します。ほとんどすべてのモバイルアプリはバックエンドサービスと対話しており、これらのサービスは私たちがよく知っているデスクトップマシン上のウェブアプリでの同じ種類の攻撃を受けやすいものです。モバイルアプリはアタックサーフェスがより小さくなり、したがってインジェクション攻撃や同様の攻撃に対してセキュリティを強化している点で異なります。代わりに、モバイルセキュリティを向上するにはデバイスとネットワーク上のデータ保護を優先する必要があります。

モバイルアプリセキュリティの主要な領域について説明します。

#### ローカルデータストレージ

ユーザー資格情報や個人情報などの機密データを保護することはモバイルセキュリティに不可欠です。アプリがローカルストレージやプロセス間通信 (IPC) などのオペレーティングシステム API を不適切に使用している場合、アプリは同じデバイス上で実行している他のアプリに機密データをさらけ出す可能性があります。また、クラウドストレージ、バックアップ、キーボードキャッシュに意図せずデータをリークする可能性もあります。さらに、モバイルデバイスは他の種類のデバイスに比べて紛失や盗難の可能性が高くなるため、ある人物がデバイスへ物理的にアクセスして容易にデータを取得できる可能性がより高くなります。

モバイルアプリを開発する場合、ユーザーデータを保存する際には細心の注意が必要です。例えば、適切なキーストレージ API を使用したり、利用可能な場合はハードウェア支援のセキュリティ機能を利用できます。

断片化は特に Android デバイスで扱う問題です。すべての Android がハードウェア支援のセキュアなストレージを提供するわけではありませんし、多くのデバイスでは時代遅れのバージョンの Android が動いています。これらの時代遅れのデバイスをサポートするアプリでは、重要なセキュリティ機能が不足している可能性のある古いバージョンの Android API を使用して作成する必要があります。セキュリティを最大限に高めるための最高の選択は、たとえ一部のユーザーを除外しても現行バージョンの API でアプリを作成することです。

#### 信頼できるエンドポイントとの通信

モバイルデバイスは一般的にさまざまなネットワークに接続します。それには他の (潜在的に悪意のある) クライアントと共有する公衆 Wi-Fi ネットワークもあります。これは単純なものから複雑なもの、古いものから新しいものまで、多種多様なネットワークベースの攻撃の機会を生み出します。モバイルアプリとリモートサービスエンドポイントの間で交換する情報の機密性と完全性を維持することは重要です。基本的な要件として、モバイルアプリは適切な設定で TLS プロトコルを使用して、ネットワーク通信にセキュアで暗号化したチャネルを設定する必要があります。

#### 認証と認可

ほとんどの場合、ユーザーがリモートサービスへログインすることはモバイルアプリのアーキテクチャ全体の不可欠な要素です。ほとんどの認証と認可のロジックはエンドポイントで行われますが、モバイルアプリ側での実装上の課題もいくつかあります。ウェブアプリとは異なり、モバイルアプリでは指紋スキャンなどのユーザーとデバイス間の認証機能によりアンロックする長時間のセッショントークンを格納することがよくあります。これによりログインが速くなりユーザーエクスペリエンスは向上します (誰も複雑なパスワードを入力したくありません) が、さらなる複雑性とエラーの余地も生じます。

モバイルアプリアーキテクチャでは、別のサービスへ認証を委譲する認証フレームワーク (OAuth2 など) の導入や、認証プロバイダへの認証プロセスのアウトソースも増えています。OAuth2 を使用すると、クライアント側の認証ロジックを同じデバイス上の他のアプリ (システムブラウザなど) にアウトソースできます。セキュリティテスト技術者はさまざまな可能な認証フレームワークやアーキテクチャの長所と短所を知る必要があります。

#### モバイルプラットフォームとの相互連携

モバイルオペレーティングシステムアーキテクチャは旧来のデスクトップアーキテクチャとは重要な点で異なります。例えば、すべてのモバイルオペレーティングシステムは特定の API へのアクセスを規制するアプリパーミッションシステムを実装しています。それらはアプリがシグナルやデータを交換できるように、多くの (Android) またはあまり豊富ではない (iOS) プロセス間通信 (IPC) 機能も提供します。これらのプラットフォーム固有の機能には独自の落とし穴があります。例えば、IPC API を悪用すると、機密データや機能をそのデバイス上で実行している他のアプリに意図せず公開する可能性があります。

#### コード品質とエクスプロイトの軽減

従来のインジェクションやメモリ管理の問題は、アタックサーフェスがより小さいため、モバイルアプリではほとんど見られません。モバイルアプリは主に信頼できるバックエンドサーバーやその UI とのインタフェースであるため、アプリに多くのバッファオーバーフロー脆弱性が存在する場合でも、これらの脆弱性は通常、有用なアタックベクトルを開放しません。ウェブアプリでは非常に一般的なクロスサイトスクリプティング (XSS は攻撃者がウェブページ内にスクリプトを注入できます)  などのブラウザエクスプロイトについても同様に適用します。但し、常に例外があります。XSS は理論的にはモバイルで可能な場合もありますが、ある個人が悪用できる XSS の問題を見ることは非常にまれです。XSS についての詳細は、「コード品質のテスト」の章の "[クロスサイトスクリプティング欠陥](0x04h-Testing-Code-Quality.md#cross-site-scripting-flaws-mstg-arch-2-and-mstg-platform-2)" のセクションを参照ください。

このインジェクションやメモリ管理の問題からの保護は、アプリ開発者がいいかげんなコードを書くことを許すものではありません。セキュリティのベストプラクティスに従うと、改竄に対する耐性がある強固な (セキュアな) リリースビルドが実現します。コンパイラやモバイル SDK が提供するフリーのセキュリティ機能はセキュリティを向上し、攻撃を緩和するのに役立ちます。

#### 改竄防止とリバース防止

宗教、政治、そしてコードの難読化。上品な会話では決して持ち出すべきではない三つのものです。多くのセキュリティ専門家はクライアント側の保護をあからさまに却下しています。しかし、ソフトウェア保護コントロールをモバイルアプリの世界で広く使用しているため、セキュリティテスト技術者はこれらの保護に対処する方法を必要としています。私たちは、明確な目的と現実的な期待を念頭に置いて保護を採用しており、セキュリティコントロールを置き換えるために使用していない場合、クライアント側の保護に利益があると考えています。

## OWASP モバイルアプリセキュリティ検証標準

このガイドは OWASP モバイルアプリケーションセキュリティ検証標準 (MASVS) と密接に関連しています。MASVS はモバイルアプリのセキュリティモデルを定義し、モバイルアプリの一般的なセキュリティ要件を示します。これはアーキテクト、開発者、テスト技術者、セキュリティ専門家、消費者がセキュアなモバイルアプリの品質を定義および理解するために使用できます。MSTG は MASVS が提供するセキュリティ要件の同じ基本セットにマップし、コンテキストに応じて個別に使用することやさまざまな目的を達成するために組み合わせることができます。

<img src="Images/Chapters/0x03/owasp-mobile-overview.jpg" width="550" />

例えば、MASVS 要件はアプリの計画およびアーキテクチャ設計の段階で使用しますが、チェックリストやテストガイドは手動セキュリティテストのベースラインとして、または開発中や開発後の自動セキュリティテストのテンプレートとして役立つかもしれません。"[モバイルアプリのセキュリティテスト](0x04b-Mobile-App-Security-Testing.md)" の章では、モバイルアプリケーションのペネトレーションテストにチェックリストや MSTG をどのように適用できるかについて説明します。

## モバイルセキュリティテストガイドの構成

MSTG には MASVS で指定しているすべての要件の説明があります。MSTG には以下の主なセクションがあります。

1. [総合テストガイド](0x04a-Mobile-App-Taxonomy.md) にはモバイルアプリのセキュリティテスト手法とモバイルアプリセキュリティに適用する一般的な脆弱性解析技法があります。また、認証とセッション管理、ネットワーク通信、暗号化など、OS に依存しない追加のテクニカルテストケースもあります。

2. [Android テストガイド](0x05a-Platform-Overview.md) には Android プラットフォーム向けのモバイルセキュリティテストをカバーします。セキュリティの基本、セキュリティテストケース、リバースエンジニアリング技法と防止、改竄技法と防止などがあります。

3. [iOS テストガイド](0x06a-Platform-Overview.md) には iOS プラットフォーム向けのモバイルセキュリティテストをカバーします。iOS OS の概要、セキュリティテスト、リバースエンジニアリング技法と防止、改竄技法と防止などがあります。
