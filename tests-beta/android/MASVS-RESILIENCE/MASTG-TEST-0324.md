---
platform: android
title: ルート検出メカニズムへの参照 (References to Root Detection Mechanisms)
id: MASTG-TEST-0324
type: [static]
weakness: MASWE-0097
best-practices: [MASTG-BEST-0029, MASTG-BEST-0030]
profiles: [R]
knowledge: [MASTG-KNOW-0027]
---

## 概要

このテストは、よくあるルート検出パターンについてアプリバイナリを静的に解析し、アプリがルート検出を実装しているかどうかをチェックします。これらには、ルート化デバイスに通常関連付けられるファイルやアーティファクトのチェック、既知のルート検出 API やライブラリの呼び出しを含むことがあります。

ルート検出技法や、探し出す具体的な API やアーティファクトの詳細情報については [ルート検出 (Root Detection)](../../../knowledge/android/MASVS-RESILIENCE/MASTG-KNOW-0027.md) を参照してください。

このテストは、特定されたルート検出メカニズムが実行時にアクティブかどうかを確認するための [ルート検出技法の実行時使用 (Runtime Use of Root Detection Techniques)](MASTG-TEST-0325.md) と組み合わせるのが最適です。このように、静的解析を使用して潜在的なルート検出ロジックを表面化し、それらの特定のチェックに動的テストを集中し、実行時にトリガーされていることを確認できます。あるいは、まず動的テストを実行して実行時にアクティブであるルート検出メカニズムを特定し、それから静的解析を使用してそれらの実装とカバレッジをさらに調査することもできます。

> [!NOTE]
> "スコープ外"  
> このテストはルート検出メカニズムの堅牢性や有効性はカバーしていません。静的解析のみで評価するのは非常に困難であり、手作業でのリバースエンジニアリングやカスタム計装を必要とすることがあります。ルート検出を効果的に実装し、その限界を理解するためのベストプラクティスについては [ルート検出を実装する (Implementing Root Detection)](../../../best-practices/MASTG-BEST-0030.md) を参照してください。

## 手順

1. [Android での静的解析 (Static Analysis on Android)](../../../techniques/android/MASTG-TECH-0014.md) を適切なパターンで使用して、逆コンパイルされたコードのルート検出 API とメソッドを検索します。

## 結果

出力には、チェックされている特定のメソッドやファイルパスなど、ルート検出チェックが実装されている場所のリストを含む可能性があります。

## 評価

アプリがルート検出チェックを実装していない場合、このテストケースは不合格です。但し、特にプロプライエタリであったり、難読化されていたり、ネイティブコードで実装されている場合、静的解析はすべてのルート検出メカニズムを検出できない可能性があることに注意してください。

ルート検出チェックが見つかった場合、これは良い兆候ですが、それでもその有効性を評価する必要があります。[ルート検出を実装する (Implementing Root Detection)](../../../best-practices/MASTG-BEST-0030.md) を参照してください。
